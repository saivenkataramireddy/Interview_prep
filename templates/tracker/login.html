{% extends 'tracker/base.html' %}
{% load static %}

{% block content %}
<style>
/* Scoped styles for the login page to match the previous modern/glass UI */
:root{
  --accent:#ffd166;
  --accent-2:#ff9a5c;
  --muted:#9aa7bd;
  --glass: rgba(255,255,255,0.03);
  --radius:20px;
}

.login-wrap{
  display:flex;
  justify-content:center;
  margin-top:28px;
  margin-bottom:28px;
}

.login-card{
  width:100%;
  max-width:980px;
  display:grid;
  grid-template-columns: 1fr 420px;
  gap:24px;
  padding:0;
  border-radius:var(--radius);
  overflow:hidden;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
  border:1px solid rgba(255,255,255,0.04);
  box-shadow: 0 30px 80px rgba(0,0,0,0.6);
  transform: translateY(12px);
  opacity:0;
  animation: cardEnter 600ms cubic-bezier(.2,.9,.2,1) forwards 120ms;
}

/* Left decorative panel */
.login-left{
  position:relative;
  padding:32px;
  background-image: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.01));
  min-height:360px;
  display:flex;
  flex-direction:column;
  justify-content:center;
  gap:18px;
}
.login-left .logo {
  display:flex;
  gap:14px;
  align-items:center;
}
.brand-logo {
  width:72px;
  height:72px;
  border-radius:14px;
  padding:10px;
  background:rgba(255,255,255,0.025);
  border:1px solid rgba(255,255,255,0.04);
}
.brand-logo img{ width:100%; height:100%; object-fit:contain; display:block; }

/* small animated title */
.left-title{
  font-size:1.4rem;
  font-weight:800;
  color:#fff;
  margin:0;
}
.left-sub{
  color:var(--muted);
  line-height:1.5;
  max-width:360px;
}

/* right form area */
.login-form-panel{
  padding:30px;
  display:flex;
  align-items:center;
  justify-content:center;
  background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));
}
.login-form{
  width:100%;
  max-width:360px;
}

.form-head{
  text-align:center;
  margin-bottom:16px;
}
.form-head h3{
  margin:0;
  font-weight:800;
  color:#fff;
}
.form-head p{ margin:0; color:var(--muted); font-size:0.95rem; }

/* inputs */
.input-field{
  width:100%;
  height:48px;
  border-radius:12px;
  padding:10px 14px;
  background:rgba(255,255,255,0.03);
  border:1px solid rgba(255,255,255,0.06);
  color:#fff;
  font-size:0.95rem;
  transition: box-shadow 180ms ease, transform 150ms ease, border-color 180ms ease;
  outline: none;
  box-sizing: border-box;
}
.input-field::placeholder{ color:rgba(255,255,255,0.45); }
.input-field:focus{
  box-shadow: 0 8px 30px rgba(255,209,102,0.06);
  transform: translateY(-2px);
  border-color: rgba(255,209,102,0.35);
}

/* password toggle */
.pw-row{ position:relative; }
.pw-toggle{
  position:absolute;
  right:10px;
  top:8px;
  height:32px;
  display:flex;
  align-items:center;
  gap:8px;
  cursor:pointer;
  color:var(--muted);
  font-size:0.9rem;
  padding:6px 8px;
  border-radius:8px;
  transition: background 150ms ease, color 150ms ease;
}
.pw-toggle:hover{ background:rgba(255,255,255,0.02); color:#fff; }

/* submit button */
.btn-login{
  width:100%;
  height:48px;
  border-radius:12px;
  border:none;
  font-weight:800;
  background: linear-gradient(90deg,var(--accent),var(--accent-2));
  color:#0b0d12;
  margin-top:8px;
}
.btn-login[disabled]{ opacity:0.8; cursor:progress; }

/* helper text / errors */
.helper{ font-size:0.9rem; color:var(--muted); min-height:20px; margin-top:8px; }
.form-errors{ color:#ffb3b3; margin-bottom:8px; }

/* small footer inside card */
.card-footer{
  margin-top:14px;
  text-align:center;
  color:var(--muted);
  font-size:0.92rem;
}

/* entrance keyframe */
@keyframes cardEnter {
  to { transform:none; opacity:1; }
}

/* responsive */
@media (max-width: 992px){
  .login-card{ grid-template-columns: 1fr; }
  .login-left{ display:none; }
  .login-wrap{ padding:14px; }
}
</style>

<div class="login-wrap">
  <div class="login-card">
    <!-- left decorative / marketing -->
    <div class="login-left" aria-hidden="true">
      <div class="logo">
        <div class="brand-logo">
          <!-- replace with your logo path -->
          <img src="{% static 'images/logo.jpeg' %}" alt="Logo">
        </div>
        <div>
          <div class="left-title">Interview Preparation Tracker</div>
          <div class="left-sub">Structured practice. Timed mocks. Progress insights. Build consistency and confidence with a focused plan.</div>
        </div>
      </div>

      <div>
        <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
          <div style="background:rgba(255,255,255,0.02); padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);">
            <strong style="display:block; color:#fff;">Curated sets</strong>
            <small style="color:var(--muted)">Algorithms • System design • Behavioural</small>
          </div>
          <div style="background:rgba(255,255,255,0.02); padding:10px; border-radius:10px; border:1px solid rgba(255,255,255,0.03);">
            <strong style="display:block; color:#fff;">Timed mocks</strong>
            <small style="color:var(--muted)">Simulate interview pressure</small>
          </div>
        </div>
      </div>
    </div>

    <!-- right: actual form -->
    <div class="login-form-panel">
      <div class="login-form" role="form" aria-labelledby="login-heading">
        <div class="form-head">
          <h3 id="login-heading">Login</h3>
          <p>Sign in to continue to your dashboard</p>
        </div>

        <form method="post" id="loginForm" novalidate>
          {% csrf_token %}
          {% if form.non_field_errors %}
            <div class="form-errors">
              {{ form.non_field_errors }}
            </div>
          {% endif %}

          <div class="mb-3">
            <label class="form-label small">Username</label>
            <input name="username" id="id_username" type="text" class="input-field" placeholder="Enter username" required>
          </div>

          <div class="mb-3 pw-row">
            <label class="form-label small">Password</label>
            <input name="password" id="id_password" type="password" class="input-field" placeholder="Enter password" required minlength="6">
            <div id="togglePw" class="pw-toggle" role="button" tabindex="0" aria-pressed="false">Show</div>
          </div>

          <div id="helper" class="helper" aria-live="polite"></div>

          <button id="btnLogin" type="submit" class="btn-login">Login</button>

          <div class="card-footer">
            Don't have an account? <a href="{% url 'signup' %}" style="color:var(--accent); font-weight:700; text-decoration:none;">Sign up</a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
/* Small JS to add micro-interactions: password toggle, live helper, loading state */
(function(){
  const toggle = document.getElementById('togglePw');
  const pw = document.getElementById('id_password');
  const form = document.getElementById('loginForm');
  const helper = document.getElementById('helper');
  const btn = document.getElementById('btnLogin');

  if (toggle && pw) {
    function setLabel(){
      toggle.textContent = pw.type === 'password' ? 'Show' : 'Hide';
      toggle.setAttribute('aria-pressed', pw.type !== 'password');
    }
    toggle.addEventListener('click', () => {
      pw.type = pw.type === 'password' ? 'text' : 'password';
      setLabel();
      pw.focus();
    });
    toggle.addEventListener('keydown', (e) => {
      if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggle.click(); }
    });
    setLabel();
  }

  // simple submit behavior: show quick loading state (demo)
  if (form) {
    form.addEventListener('submit', (e) => {
      // keep default submission when using real backend; for UX show loader briefly
      btn.disabled = true;
      const original = btn.innerHTML;
      btn.innerHTML = 'Signing in...';
      helper.style.color = 'var(--muted)';
      helper.textContent = '';

      // If you want immediate submit to backend, comment out the timeout and allow default behavior.
      // Demo timeout to show micro-interaction:
      setTimeout(() => {
        btn.disabled = false;
        btn.innerHTML = original;
      }, 1200);
    });
  }
})();
</script>
{% endblock %}
